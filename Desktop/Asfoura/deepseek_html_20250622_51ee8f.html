<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Management Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e7f4 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .dashboard-container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .task-card {
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border-radius: 12px;
            overflow: hidden;
        }
        
        .task-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }
        
        .progress-container {
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            transition: width 0.6s ease;
        }
        
        .stage-bar {
            height: 6px;
            border-radius: 3px;
        }
        
        .priority-indicator {
            width: 6px;
            border-radius: 3px 0 0 3px;
        }
        
        .person-avatar {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-weight: 600;
            color: white;
            font-size: 14px;
        }
        
        .header-gradient {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        }
        
        .filter-btn {
            transition: all 0.2s ease;
        }
        
        .filter-btn.active {
            background: #4f46e5;
            color: white;
        }
        
        .detail-view {
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .priority-badge {
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 20px;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            animation: modalEnter 0.3s ease;
        }
        
        @keyframes modalEnter {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Firebase configuration (replace with your own config)
        const firebaseConfig = {
            apiKey: "AIzaSyDxqgZ0xwWwVX4X7X1X2X3X4X5X6X7X8X9",
            authDomain: "your-project-id.firebaseapp.com",
            projectId: "your-project-id",
            storageBucket: "your-project-id.appspot.com",
            messagingSenderId: "1234567890",
            appId: "1:1234567890:web:abcdef1234567890"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        // Current user ID (for demo, replace with your auth system)
        const currentUserId = "user123";
        
        // TaskCard Component
        function TaskCard({ project, onClick }) {
            // Priority colors
            const priorityColors = {
                urgent: "bg-red-500",
                medium: "bg-yellow-500",
                normal: "bg-green-500"
            };
            
            // Priority badge text
            const priorityText = {
                urgent: "URGENT",
                medium: "MEDIUM",
                normal: "NORMAL"
            };
            
            // Priority badge colors
            const priorityBadgeColors = {
                urgent: "bg-red-100 text-red-800",
                medium: "bg-yellow-100 text-yellow-800",
                normal: "bg-green-100 text-green-800"
            };
            
            // Stage colors
            const stageColors = ['bg-blue-500', 'bg-purple-500', 'bg-green-500', 'bg-yellow-500', 'bg-indigo-500'];
            
            // Format date
            const formatDate = (dateString) => {
                const options = { month: 'short', day: 'numeric' };
                return new Date(dateString).toLocaleDateString(undefined, options);
            };

            return (
                <div 
                    className="task-card bg-white flex h-full"
                    onClick={() => onClick(project)}
                >
                    <div className={`priority-indicator ${priorityColors[project.priority]}`}></div>
                    <div className="p-5 flex-1">
                        <div className="flex justify-between items-start">
                            <h3 className="font-bold text-lg text-gray-800">{project.title}</h3>
                            <div className={`priority-badge ${priorityBadgeColors[project.priority]} font-medium`}>
                                {priorityText[project.priority]}
                            </div>
                        </div>
                        <p className="text-gray-500 text-sm mt-1">{project.description}</p>
                        
                        <div className="mt-5 space-y-3">
                            <div>
                                <div className="flex justify-between text-sm mb-1">
                                    <span className="text-gray-600">Coding</span>
                                    <span className="font-medium">{project.progress.coding}%</span>
                                </div>
                                <div className="progress-container bg-gray-200">
                                    <div 
                                        className="progress-bar bg-blue-500" 
                                        style={{ width: `${project.progress.coding}%` }}
                                    ></div>
                                </div>
                            </div>
                            
                            <div>
                                <div className="flex justify-between text-sm mb-1">
                                    <span className="text-gray-600">Story</span>
                                    <span className="font-medium">{project.progress.story}%</span>
                                </div>
                                <div className="progress-container bg-gray-200">
                                    <div 
                                        className="progress-bar bg-purple-500" 
                                        style={{ width: `${project.progress.story}%` }}
                                    ></div>
                                </div>
                            </div>
                            
                            <div>
                                <div className="flex justify-between text-sm mb-1">
                                    <span className="text-gray-600">UI/UX</span>
                                    <span className="font-medium">{project.progress.ui}%</span>
                                </div>
                                <div className="progress-container bg-gray-200">
                                    <div 
                                        className="progress-bar bg-green-500" 
                                        style={{ width: `${project.progress.ui}%` }}
                                    ></div>
                                </div>
                            </div>
                        </div>
                        
                        <div className="mt-4">
                            <p className="text-sm text-gray-600 mb-2">Task Stages</p>
                            <div className="flex h-2 rounded-full bg-gray-200 overflow-hidden">
                                {stageColors.map((color, index) => (
                                    <div 
                                        key={index}
                                        className={`stage-bar ${index < project.stagesCompleted ? color : 'bg-gray-300'} ${index === 0 ? 'rounded-l-full' : ''} ${index === 4 ? 'rounded-r-full' : ''}`}
                                        style={{ width: "20%" }}
                                    ></div>
                                ))}
                            </div>
                            <div className="flex justify-between text-xs text-gray-500 mt-1">
                                <span>Planning</span>
                                <span>Design</span>
                                <span>Dev</span>
                                <span>Testing</span>
                                <span>Launch</span>
                            </div>
                        </div>
                        
                        <div className="mt-5">
                            <p className="text-sm font-medium text-gray-700 mb-2">Team Members</p>
                            <div className="flex space-x-2">
                                {project.teamMembers.map((member, index) => (
                                    <div 
                                        key={index}
                                        className="person-avatar"
                                        style={{ 
                                            backgroundColor: `hsl(${member.id * 36}, 70%, 50%)`
                                        }}
                                        title={member.name}
                                    >
                                        {member.initials}
                                    </div>
                                ))}
                            </div>
                        </div>
                        
                        <div className="mt-5 flex justify-between items-center border-t border-gray-100 pt-4">
                            <div className="text-sm text-gray-500">
                                <i className="far fa-calendar mr-1"></i> Due: {formatDate(project.dueDate)}
                            </div>
                            <div className="flex space-x-3 text-gray-500">
                                <button className="hover:text-indigo-600">
                                    <i className="far fa-edit"></i>
                                </button>
                                <button className="hover:text-indigo-600">
                                    <i className="far fa-comment"></i>
                                </button>
                                <button className="hover:text-indigo-600">
                                    <i className="fas fa-ellipsis-h"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // ProjectDetail Component
        function ProjectDetail({ project, onBack }) {
            if (!project) return null;
            
            // Priority colors
            const priorityColors = {
                urgent: "bg-red-500",
                medium: "bg-yellow-500",
                normal: "bg-green-500"
            };
            
            // Priority text
            const priorityText = {
                urgent: "URGENT",
                medium: "MEDIUM",
                normal: "NORMAL"
            };
            
            // Format date
            const formatDate = (dateString) => {
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                return new Date(dateString).toLocaleDateString(undefined, options);
            };
            
            // Calculate days remaining
            const daysRemaining = () => {
                const dueDate = new Date(project.dueDate);
                const today = new Date();
                const diffTime = dueDate - today;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                return diffDays > 0 ? `${diffDays} days` : "Overdue";
            };

            return (
                <div className="detail-view bg-white rounded-xl p-6 shadow-lg max-w-4xl mx-auto">
                    <button 
                        onClick={onBack}
                        className="mb-6 flex items-center text-indigo-600 hover:text-indigo-800"
                    >
                        <i className="fas fa-arrow-left mr-2"></i> Back to Dashboard
                    </button>
                    
                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                        <div>
                            <h1 className="text-3xl font-bold text-gray-800">{project.title}</h1>
                            <p className="text-gray-600 mt-2">{project.description}</p>
                        </div>
                        <div className={`mt-4 md:mt-0 px-4 py-2 rounded-full font-semibold ${priorityText[project.priority] === "URGENT" ? "bg-red-100 text-red-800" : priorityText[project.priority] === "MEDIUM" ? "bg-yellow-100 text-yellow-800" : "bg-green-100 text-green-800"}`}>
                            {priorityText[project.priority]} PRIORITY
                        </div>
                    </div>
                    
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div className="bg-gray-50 p-4 rounded-lg">
                            <h3 className="text-gray-500 text-sm mb-1">Start Date</h3>
                            <p className="font-medium">{formatDate(project.startDate)}</p>
                        </div>
                        <div className="bg-gray-50 p-4 rounded-lg">
                            <h3 className="text-gray-500 text-sm mb-1">Due Date</h3>
                            <p className="font-medium">{formatDate(project.dueDate)}</p>
                        </div>
                        <div className="bg-gray-50 p-4 rounded-lg">
                            <h3 className="text-gray-500 text-sm mb-1">Time Remaining</h3>
                            <p className="font-medium">{daysRemaining()}</p>
                        </div>
                    </div>
                    
                    <div className="mb-8">
                        <h2 className="text-xl font-semibold text-gray-800 mb-4">Progress Overview</h2>
                        <div className="space-y-4">
                            <div>
                                <div className="flex justify-between mb-1">
                                    <span className="text-gray-700">Coding Progress</span>
                                    <span className="font-medium">{project.progress.coding}%</span>
                                </div>
                                <div className="h-3 bg-gray-200 rounded-full overflow-hidden">
                                    <div 
                                        className="h-full bg-blue-500" 
                                        style={{ width: `${project.progress.coding}%` }}
                                    ></div>
                                </div>
                            </div>
                            <div>
                                <div className="flex justify-between mb-1">
                                    <span className="text-gray-700">Story Progress</span>
                                    <span className="font-medium">{project.progress.story}%</span>
                                </div>
                                <div className="h-3 bg-gray-200 rounded-full overflow-hidden">
                                    <div 
                                        className="h-full bg-purple-500" 
                                        style={{ width: `${project.progress.story}%` }}
                                    ></div>
                                </div>
                            </div>
                            <div>
                                <div className="flex justify-between mb-1">
                                    <span className="text-gray-700">UI/UX Progress</span>
                                    <span className="font-medium">{project.progress.ui}%</span>
                                </div>
                                <div className="h-3 bg-gray-200 rounded-full overflow-hidden">
                                    <div 
                                        className="h-full bg-green-500" 
                                        style={{ width: `${project.progress.ui}%` }}
                                    ></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div className="mb-8">
                        <h2 className="text-xl font-semibold text-gray-800 mb-4">Team Members</h2>
                        <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
                            {project.teamMembers.map((member, index) => (
                                <div key={index} className="flex items-center p-3 bg-gray-50 rounded-lg">
                                    <div 
                                        className="w-10 h-10 rounded-full flex items-center justify-center text-white font-medium mr-3"
                                        style={{ backgroundColor: `hsl(${member.id * 36}, 70%, 50%)` }}
                                    >
                                        {member.initials}
                                    </div>
                                    <div>
                                        <p className="font-medium">{member.name}</p>
                                        <p className="text-sm text-gray-600">Team Member</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                    
                    <div>
                        <h2 className="text-xl font-semibold text-gray-800 mb-4">Task Stages</h2>
                        <div className="flex items-center mb-4">
                            <div className="w-24 text-sm text-gray-600">Planning</div>
                            <div className="flex-1 h-3 bg-gray-200 rounded-full overflow-hidden">
                                <div className={`h-full w-full ${project.stagesCompleted > 0 ? 'bg-blue-500' : 'bg-gray-300'}`}></div>
                            </div>
                        </div>
                        <div className="flex items-center mb-4">
                            <div className="w-24 text-sm text-gray-600">Design</div>
                            <div className="flex-1 h-3 bg-gray-200 rounded-full overflow-hidden">
                                <div className={`h-full w-full ${project.stagesCompleted > 1 ? 'bg-purple-500' : 'bg-gray-300'}`}></div>
                            </div>
                        </div>
                        <div className="flex items-center mb-4">
                            <div className="w-24 text-sm text-gray-600">Development</div>
                            <div className="flex-1 h-3 bg-gray-200 rounded-full overflow-hidden">
                                <div className={`h-full w-full ${project.stagesCompleted > 2 ? 'bg-green-500' : 'bg-gray-300'}`}></div>
                            </div>
                        </div>
                        <div className="flex items-center mb-4">
                            <div className="w-24 text-sm text-gray-600">Testing</div>
                            <div className="flex-1 h-3 bg-gray-200 rounded-full overflow-hidden">
                                <div className={`h-full w-full ${project.stagesCompleted > 3 ? 'bg-yellow-500' : 'bg-gray-300'}`}></div>
                            </div>
                        </div>
                        <div className="flex items-center">
                            <div className="w-24 text-sm text-gray-600">Launch</div>
                            <div className="flex-1 h-3 bg-gray-200 rounded-full overflow-hidden">
                                <div className={`h-full w-full ${project.stagesCompleted > 4 ? 'bg-indigo-500' : 'bg-gray-300'}`}></div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Project Form Component
        function ProjectForm({ onClose, onProjectCreated }) {
            const [formData, setFormData] = React.useState({
                title: '',
                description: '',
                priority: 'normal',
                progress: { coding: 0, story: 0, ui: 0 },
                stagesCompleted: 1,
                dueDate: new Date().toISOString().split('T')[0],
                teamMembers: [{ id: 1, name: 'John Doe', initials: 'JD' }]
            });
            
            const [newMember, setNewMember] = React.useState({ name: '', initials: '' });
            const [loading, setLoading] = React.useState(false);
            
            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };
            
            const handleProgressChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({
                    ...prev,
                    progress: {
                        ...prev.progress,
                        [name]: parseInt(value)
                    }
                }));
            };
            
            const handleAddMember = () => {
                if (newMember.name && newMember.initials) {
                    setFormData(prev => ({
                        ...prev,
                        teamMembers: [
                            ...prev.teamMembers,
                            { 
                                id: prev.teamMembers.length + 1,
                                name: newMember.name,
                                initials: newMember.initials 
                            }
                        ]
                    }));
                    setNewMember({ name: '', initials: '' });
                }
            };
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                setLoading(true);
                
                try {
                    // Add current user ID to project
                    const projectData = {
                        ...formData,
                        userId: currentUserId,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    // Save to Firestore
                    await db.collection('projects').add(projectData);
                    
                    // Reset form
                    setFormData({
                        title: '',
                        description: '',
                        priority: 'normal',
                        progress: { coding: 0, story: 0, ui: 0 },
                        stagesCompleted: 1,
                        dueDate: new Date().toISOString().split('T')[0],
                        teamMembers: [{ id: 1, name: 'John Doe', initials: 'JD' }]
                    });
                    
                    onProjectCreated();
                    onClose();
                } catch (error) {
                    console.error("Error adding project: ", error);
                } finally {
                    setLoading(false);
                }
            };
            
            return (
                <div className="modal-overlay">
                    <div className="modal-content">
                        <div className="p-6">
                            <div className="flex justify-between items-center mb-6">
                                <h2 className="text-2xl font-bold text-gray-800">Create New Project</h2>
                                <button 
                                    onClick={onClose}
                                    className="text-gray-500 hover:text-gray-700"
                                >
                                    <i className="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <form onSubmit={handleSubmit}>
                                <div className="mb-4">
                                    <label className="block text-gray-700 text-sm font-medium mb-2">
                                        Project Title
                                    </label>
                                    <input
                                        type="text"
                                        name="title"
                                        value={formData.title}
                                        onChange={handleChange}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        required
                                    />
                                </div>
                                
                                <div className="mb-4">
                                    <label className="block text-gray-700 text-sm font-medium mb-2">
                                        Description
                                    </label>
                                    <textarea
                                        name="description"
                                        value={formData.description}
                                        onChange={handleChange}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        rows="3"
                                        required
                                    ></textarea>
                                </div>
                                
                                <div className="mb-4">
                                    <label className="block text-gray-700 text-sm font-medium mb-2">
                                        Priority
                                    </label>
                                    <select
                                        name="priority"
                                        value={formData.priority}
                                        onChange={handleChange}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                    >
                                        <option value="normal">Normal</option>
                                        <option value="medium">Medium</option>
                                        <option value="urgent">Urgent</option>
                                    </select>
                                </div>
                                
                                <div className="mb-4">
                                    <label className="block text-gray-700 text-sm font-medium mb-2">
                                        Progress
                                    </label>
                                    <div className="grid grid-cols-3 gap-4">
                                        <div>
                                            <label className="block text-xs text-gray-500 mb-1">Coding</label>
                                            <input
                                                type="range"
                                                name="coding"
                                                min="0"
                                                max="100"
                                                value={formData.progress.coding}
                                                onChange={handleProgressChange}
                                                className="w-full"
                                            />
                                            <div className="text-center text-sm">{formData.progress.coding}%</div>
                                        </div>
                                        <div>
                                            <label className="block text-xs text-gray-500 mb-1">Story</label>
                                            <input
                                                type="range"
                                                name="story"
                                                min="0"
                                                max="100"
                                                value={formData.progress.story}
                                                onChange={handleProgressChange}
                                                className="w-full"
                                            />
                                            <div className="text-center text-sm">{formData.progress.story}%</div>
                                        </div>
                                        <div>
                                            <label className="block text-xs text-gray-500 mb-1">UI/UX</label>
                                            <input
                                                type="range"
                                                name="ui"
                                                min="0"
                                                max="100"
                                                value={formData.progress.ui}
                                                onChange={handleProgressChange}
                                                className="w-full"
                                            />
                                            <div className="text-center text-sm">{formData.progress.ui}%</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="mb-4">
                                    <label className="block text-gray-700 text-sm font-medium mb-2">
                                        Task Stages Completed
                                    </label>
                                    <select
                                        name="stagesCompleted"
                                        value={formData.stagesCompleted}
                                        onChange={(e) => setFormData(prev => ({...prev, stagesCompleted: parseInt(e.target.value)}))}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                    >
                                        <option value="1">1 - Planning</option>
                                        <option value="2">2 - Design</option>
                                        <option value="3">3 - Development</option>
                                        <option value="4">4 - Testing</option>
                                        <option value="5">5 - Launch</option>
                                    </select>
                                </div>
                                
                                <div className="mb-4">
                                    <label className="block text-gray-700 text-sm font-medium mb-2">
                                        Due Date
                                    </label>
                                    <input
                                        type="date"
                                        name="dueDate"
                                        value={formData.dueDate}
                                        onChange={handleChange}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        required
                                    />
                                </div>
                                
                                <div className="mb-6">
                                    <label className="block text-gray-700 text-sm font-medium mb-2">
                                        Team Members
                                    </label>
                                    <div className="mb-3">
                                        {formData.teamMembers.map((member, index) => (
                                            <div key={index} className="flex items-center mb-2">
                                                <div 
                                                    className="w-8 h-8 rounded-full flex items-center justify-center text-white mr-2"
                                                    style={{ backgroundColor: `hsl(${member.id * 36}, 70%, 50%)` }}
                                                >
                                                    {member.initials}
                                                </div>
                                                <span>{member.name}</span>
                                            </div>
                                        ))}
                                    </div>
                                    
                                    <div className="flex space-x-2">
                                        <input
                                            type="text"
                                            placeholder="Name"
                                            value={newMember.name}
                                            onChange={(e) => setNewMember({...newMember, name: e.target.value})}
                                            className="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        />
                                        <input
                                            type="text"
                                            placeholder="Initials"
                                            value={newMember.initials}
                                            onChange={(e) => setNewMember({...newMember, initials: e.target.value.toUpperCase()})}
                                            className="w-20 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                            maxLength="2"
                                        />
                                        <button
                                            type="button"
                                            onClick={handleAddMember}
                                            className="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 transition"
                                        >
                                            Add
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="flex justify-end space-x-3">
                                    <button
                                        type="button"
                                        onClick={onClose}
                                        className="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100 transition"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        type="submit"
                                        className="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition flex items-center"
                                        disabled={loading}
                                    >
                                        {loading ? (
                                            <>
                                                <i className="fas fa-spinner fa-spin mr-2"></i>
                                                Creating...
                                            </>
                                        ) : (
                                            <>
                                                <i className="fas fa-plus mr-2"></i>
                                                Create Project
                                            </>
                                        )}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            );
        }

        // Dashboard Component
        function Dashboard() {
            const [projects, setProjects] = React.useState([]);
            const [filteredProjects, setFilteredProjects] = React.useState([]);
            const [selectedProject, setSelectedProject] = React.useState(null);
            const [filters, setFilters] = React.useState({
                priority: 'all',
                sort: 'dueDate',
                search: ''
            });
            const [loading, setLoading] = React.useState(true);
            const [showProjectForm, setShowProjectForm] = React.useState(false);
            
            // Fetch projects from Firestore
            React.useEffect(() => {
                const fetchProjects = async () => {
                    try {
                        setLoading(true);
                        const snapshot = await db.collection('projects')
                            .where('userId', '==', currentUserId)
                            .orderBy('createdAt', 'desc')
                            .get();
                        
                        const projectsData = snapshot.docs.map(doc => ({
                            id: doc.id,
                            ...doc.data()
                        }));
                        
                        setProjects(projectsData);
                        setFilteredProjects(projectsData);
                    } catch (error) {
                        console.error("Error fetching projects: ", error);
                    } finally {
                        setLoading(false);
                    }
                };
                
                fetchProjects();
                
                // Set up real-time listener
                const unsubscribe = db.collection('projects')
                    .where('userId', '==', currentUserId)
                    .orderBy('createdAt', 'desc')
                    .onSnapshot(snapshot => {
                        const projectsData = snapshot.docs.map(doc => ({
                            id: doc.id,
                            ...doc.data()
                        }));
                        setProjects(projectsData);
                    });
                
                return () => unsubscribe();
            }, []);
            
            // Filter and sort projects when filters change
            React.useEffect(() => {
                let result = [...projects];
                
                // Apply priority filter
                if (filters.priority !== 'all') {
                    result = result.filter(project => project.priority === filters.priority);
                }
                
                // Apply search filter
                if (filters.search) {
                    const searchTerm = filters.search.toLowerCase();
                    result = result.filter(project => 
                        project.title.toLowerCase().includes(searchTerm) || 
                        project.description.toLowerCase().includes(searchTerm) ||
                        project.teamMembers.some(member => 
                            member.name.toLowerCase().includes(searchTerm)
                        )
                    );
                }
                
                // Apply sorting
                if (filters.sort === 'dueDate') {
                    result.sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));
                } else if (filters.sort === 'priority') {
                    const priorityOrder = { urgent: 1, medium: 2, normal: 3 };
                    result.sort((a, b) => priorityOrder[a.priority] - priorityOrder[b.priority]);
                } else if (filters.sort === 'title') {
                    result.sort((a, b) => a.title.localeCompare(b.title));
                }
                
                setFilteredProjects(result);
            }, [filters, projects]);
            
            // Handle filter change
            const handleFilterChange = (filterType, value) => {
                setFilters(prev => ({
                    ...prev,
                    [filterType]: value
                }));
            };
            
            // View project details
            const viewProjectDetails = (project) => {
                setSelectedProject(project);
            };
            
            // Back to dashboard
            const backToDashboard = () => {
                setSelectedProject(null);
            };
            
            // Open project form
            const openProjectForm = () => {
                setShowProjectForm(true);
            };
            
            // Close project form
            const closeProjectForm = () => {
                setShowProjectForm(false);
            };
            
            // Handle new project created
            const handleProjectCreated = () => {
                // Projects will update automatically via the real-time listener
            };
            
            // Render dashboard view
            const renderDashboard = () => (
                <div className="dashboard-container">
                    {/* Header */}
                    <div className="header-gradient rounded-2xl p-6 mb-8 text-white">
                        <div className="flex flex-col md:flex-row justify-between items-start md:items-center">
                            <div className="mb-4 md:mb-0">
                                <h1 className="text-3xl font-bold">Project Dashboard</h1>
                                <p className="text-indigo-200 mt-2">Track progress and manage team tasks</p>
                            </div>
                            <div className="flex items-center space-x-4">
                                <div className="relative">
                                    <input 
                                        type="text" 
                                        placeholder="Search projects..." 
                                        className="bg-indigo-500/30 text-white placeholder-indigo-200 rounded-full py-2 px-4 pl-10 focus:outline-none focus:ring-2 focus:ring-indigo-300 w-full"
                                        value={filters.search}
                                        onChange={(e) => handleFilterChange('search', e.target.value)}
                                    />
                                    <i className="fas fa-search absolute left-3 top-3 text-indigo-200"></i>
                                </div>
                                <div className="bg-indigo-500/30 w-10 h-10 rounded-full flex items-center justify-center">
                                    <i className="fas fa-bell"></i>
                                </div>
                                <div className="bg-indigo-500/30 w-10 h-10 rounded-full flex items-center justify-center">
                                    <i className="fas fa-user"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div className="flex flex-wrap mt-8 gap-2">
                            <button 
                                className={`filter-btn px-4 py-2 rounded-lg font-medium ${filters.priority === 'all' ? 'bg-white text-indigo-700' : 'bg-indigo-600/50 text-white hover:bg-indigo-600/70'}`}
                                onClick={() => handleFilterChange('priority', 'all')}
                            >
                                All Projects
                            </button>
                            <button 
                                className={`filter-btn px-4 py-2 rounded-lg font-medium ${filters.priority === 'urgent' ? 'bg-white text-indigo-700' : 'bg-indigo-600/50 text-white hover:bg-indigo-600/70'}`}
                                onClick={() => handleFilterChange('priority', 'urgent')}
                            >
                                Urgent
                            </button>
                            <button 
                                className={`filter-btn px-4 py-2 rounded-lg font-medium ${filters.priority === 'medium' ? 'bg-white text-indigo-700' : 'bg-indigo-600/50 text-white hover:bg-indigo-600/70'}`}
                                onClick={() => handleFilterChange('priority', 'medium')}
                            >
                                Medium
                            </button>
                            <button 
                                className={`filter-btn px-4 py-2 rounded-lg font-medium ${filters.priority === 'normal' ? 'bg-white text-indigo-700' : 'bg-indigo-600/50 text-white hover:bg-indigo-600/70'}`}
                                onClick={() => handleFilterChange('priority', 'normal')}
                            >
                                Normal
                            </button>
                        </div>
                    </div>
                    
                    {/* Stats Overview */}
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                        <div className="bg-white rounded-xl p-5 shadow-sm">
                            <div className="flex justify-between items-center">
                                <div>
                                    <p className="text-gray-500 text-sm">Total Projects</p>
                                    <p className="text-2xl font-bold mt-1">{projects.length}</p>
                                </div>
                                <div className="bg-blue-100 w-12 h-12 rounded-lg flex items-center justify-center">
                                    <i className="fas fa-folder-open text-blue-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div className="bg-white rounded-xl p-5 shadow-sm">
                            <div className="flex justify-between items-center">
                                <div>
                                    <p className="text-gray-500 text-sm">Active Projects</p>
                                    <p className="text-2xl font-bold mt-1">
                                        {projects.filter(p => new Date(p.dueDate) > new Date()).length}
                                    </p>
                                </div>
                                <div className="bg-green-100 w-12 h-12 rounded-lg flex items-center justify-center">
                                    <i className="fas fa-tasks text-green-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div className="bg-white rounded-xl p-5 shadow-sm">
                            <div className="flex justify-between items-center">
                                <div>
                                    <p className="text-gray-500 text-sm">Team Members</p>
                                    <p className="text-2xl font-bold mt-1">
                                        {projects.reduce((count, project) => count + project.teamMembers.length, 0)}
                                    </p>
                                </div>
                                <div className="bg-purple-100 w-12 h-12 rounded-lg flex items-center justify-center">
                                    <i className="fas fa-users text-purple-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        <div className="bg-white rounded-xl p-5 shadow-sm">
                            <div className="flex justify-between items-center">
                                <div>
                                    <p className="text-gray-500 text-sm">Deadlines</p>
                                    <p className="text-2xl font-bold mt-1">
                                        {projects.filter(p => new Date(p.dueDate) < new Date()).length}
                                    </p>
                                </div>
                                <div className="bg-red-100 w-12 h-12 rounded-lg flex items-center justify-center">
                                    <i className="fas fa-calendar-day text-red-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
                        <h2 className="text-2xl font-bold text-gray-800 mb-4 md:mb-0">My Projects</h2>
                        <div className="flex flex-wrap gap-3">
                            <div className="flex items-center">
                                <span className="text-gray-600 mr-2">Sort by:</span>
                                <select 
                                    className="border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                    value={filters.sort}
                                    onChange={(e) => handleFilterChange('sort', e.target.value)}
                                >
                                    <option value="dueDate">Due Date</option>
                                    <option value="priority">Priority</option>
                                    <option value="title">Project Name</option>
                                </select>
                            </div>
                            <button 
                                onClick={openProjectForm}
                                className="bg-indigo-600 text-white px-4 py-2 rounded-lg font-medium flex items-center"
                            >
                                <i className="fas fa-plus mr-2"></i> New Project
                            </button>
                        </div>
                    </div>
                    
                    {/* Task Cards Grid */}
                    {loading ? (
                        <div className="text-center py-12">
                            <i className="fas fa-spinner fa-spin text-4xl text-indigo-600 mb-4"></i>
                            <p className="text-gray-600">Loading projects...</p>
                        </div>
                    ) : (
                        <>
                            <div className="dashboard-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                {filteredProjects.map(project => (
                                    <TaskCard 
                                        key={project.id} 
                                        project={project} 
                                        onClick={viewProjectDetails}
                                    />
                                ))}
                                
                                {filteredProjects.length === 0 && (
                                    <div className="col-span-3 text-center py-12">
                                        <i className="fas fa-inbox text-4xl text-gray-300 mb-4"></i>
                                        <h3 className="text-xl font-medium text-gray-500">No projects found</h3>
                                        <p className="text-gray-400 mt-2">Try creating a new project or adjusting your filters</p>
                                        <button 
                                            onClick={openProjectForm}
                                            className="mt-4 bg-indigo-600 text-white px-4 py-2 rounded-lg font-medium flex items-center mx-auto"
                                        >
                                            <i className="fas fa-plus mr-2"></i> Create First Project
                                        </button>
                                    </div>
                                )}
                            </div>
                        </>
                    )}
                </div>
            );
            
            return (
                <div>
                    {selectedProject ? (
                        <ProjectDetail 
                            project={selectedProject} 
                            onBack={backToDashboard} 
                        />
                    ) : (
                        renderDashboard()
                    )}
                    
                    {showProjectForm && (
                        <ProjectForm 
                            onClose={closeProjectForm} 
                            onProjectCreated={handleProjectCreated}
                        />
                    )}
                </div>
            );
        }

        // App Component
        function App() {
            return (
                <div>
                    <Dashboard />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>